awk -F'|' ' $0 !~ /^#/ && $0 !~ /SYSTEM:/ && $0 !~ /CONFIG:/ && $0 !~ /CHECKSUM:/ {
    for (i=1; i<=NF; i++) {
        gsub(/^ +| +$/, "", $i)
    }

    if ($3 == "Mars" && $4 == "Completed") {
        if ($6 > max_duration) {
            max_duration = $6
            code = $8
        }
    }
}

END {
    print code
}
' space_missions.log